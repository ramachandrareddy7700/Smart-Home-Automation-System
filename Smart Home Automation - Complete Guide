# Smart Home Automation System - Complete Implementation Guide

## ğŸ“‹ Table of Contents
1. [Hardware Requirements](#hardware-requirements)
2. [Circuit Connections](#circuit-connections)
3. [Software Setup](#software-setup)
4. [Step-by-Step Implementation](#implementation-steps)
5. [API Documentation](#api-documentation)
6. [Troubleshooting](#troubleshooting)
7. [Advanced Features](#advanced-features)

---

## ğŸ› ï¸ Hardware Requirements

### Essential Components
- **ESP32 Development Board** (1x)
- **4-Channel Relay Module** (1x) - 5V with optocoupler
- **DHT22 Temperature & Humidity Sensor** (1x)
- **PIR Motion Sensor** (1x) - HC-SR501
- **LDR (Light Dependent Resistor)** (1x)
- **10kÎ© Resistor** (1x) - for LDR voltage divider
- **5V Power Supply** (1x) - minimum 2A
- **Jumper Wires** - Male-to-Female and Male-to-Male
- **Breadboard** (1x) - for prototyping
- **AC Bulbs/Appliances** - for testing (use safely!)

### Optional Components
- **OLED Display** (0.96" or 1.3") - for local status display
- **Push Buttons** - for manual override
- **Buzzer** - for alerts
- **RGB LED** - for status indication

---

## ğŸ”Œ Circuit Connections

### ESP32 Pinout Configuration

```
ESP32 Pin â†’ Component
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
GPIO 12   â†’ Relay 1 (IN1) - Light 1
GPIO 13   â†’ Relay 2 (IN2) - Light 2
GPIO 14   â†’ Relay 3 (IN3) - Fan
GPIO 27   â†’ Relay 4 (IN4) - Outlet

GPIO 15   â†’ DHT22 (Data Pin)
GPIO 25   â†’ PIR Motion Sensor (OUT)
GPIO 34   â†’ LDR (via voltage divider)

VIN       â†’ 5V Power Supply (+)
GND       â†’ Common Ground
```

### Detailed Connection Diagrams

#### 1. Relay Module Connection
```
Relay Module    ESP32        AC Circuit
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
VCC         â†’   5V (VIN)
GND         â†’   GND
IN1         â†’   GPIO 12
IN2         â†’   GPIO 13
IN3         â†’   GPIO 14
IN4         â†’   GPIO 27

COM (Common) â†’ Live Wire (AC)
NO (Normally Open) â†’ Appliance â†’ Neutral
```

**âš ï¸ SAFETY WARNING:** 
- Work with AC circuits only when power is OFF
- Use proper insulation and enclosures
- Consider using licensed electrician for final installation
- Test with low-voltage devices first (DC bulbs/LEDs)

#### 2. DHT22 Sensor
```
DHT22 Pin    ESP32
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
VCC      â†’   3.3V
DATA     â†’   GPIO 15
GND      â†’   GND
```

#### 3. PIR Motion Sensor
```
PIR Pin      ESP32
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
VCC      â†’   5V (VIN)
OUT      â†’   GPIO 25
GND      â†’   GND
```

#### 4. LDR (Light Sensor) with Voltage Divider
```
        3.3V
         |
        LDR
         |
         â”œâ”€â”€â”€â”€ GPIO 34 (Analog Input)
         |
       10kÎ©
         |
        GND
```

---

## ğŸ’» Software Setup

### 1. Install Arduino IDE
1. Download from [arduino.cc](https://www.arduino.cc/en/software)
2. Install for your operating system

### 2. Setup ESP32 Board Support
1. Open Arduino IDE
2. Go to **File â†’ Preferences**
3. Add to "Additional Board Manager URLs":
   ```
   https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json
   ```
4. Go to **Tools â†’ Board â†’ Board Manager**
5. Search "ESP32" and install "esp32 by Espressif Systems"

### 3. Install Required Libraries
Go to **Sketch â†’ Include Library â†’ Manage Libraries**, search and install:
- **DHT sensor library** by Adafruit
- **Adafruit Unified Sensor** (dependency)
- **WebServer** (included with ESP32 core)

### 4. Configure the Code
Open the ESP32 code and modify:
```cpp
const char* ssid = "YOUR_WIFI_SSID";        // Your WiFi name
const char* password = "YOUR_WIFI_PASSWORD"; // Your WiFi password
```

---

## ğŸ“ Step-by-Step Implementation

### Phase 1: Basic Setup (Day 1)

#### Step 1: Test ESP32 WiFi Connection
```cpp
// Upload this simple test first
#include <WiFi.h>

const char* ssid = "YOUR_WIFI";
const char* password = "YOUR_PASSWORD";

void setup() {
  Serial.begin(115200);
  WiFi.begin(ssid, password);
  
  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }
  
  Serial.println("\nConnected!");
  Serial.println(WiFi.localIP());
}

void loop() {}
```
**Expected Result:** IP address printed in Serial Monitor

#### Step 2: Test Individual Relay Control
```cpp
#define RELAY_PIN 12

void setup() {
  pinMode(RELAY_PIN, OUTPUT);
}

void loop() {
  digitalWrite(RELAY_PIN, HIGH);  // Relay ON
  delay(2000);
  digitalWrite(RELAY_PIN, LOW);   // Relay OFF
  delay(2000);
}
```
**Expected Result:** Relay clicks ON/OFF every 2 seconds

#### Step 3: Test DHT22 Sensor
```cpp
#include <DHT.h>

#define DHT_PIN 15
#define DHT_TYPE DHT22

DHT dht(DHT_PIN, DHT_TYPE);

void setup() {
  Serial.begin(115200);
  dht.begin();
}

void loop() {
  float temp = dht.readTemperature();
  float hum = dht.readHumidity();
  
  Serial.print("Temp: ");
  Serial.print(temp);
  Serial.print("Â°C | Humidity: ");
  Serial.print(hum);
  Serial.println("%");
  
  delay(2000);
}
```

### Phase 2: Web Server Integration (Day 2)

1. Upload the complete ESP32 code
2. Open Serial Monitor (115200 baud)
3. Note the IP address displayed
4. Open browser and navigate to: `http://[ESP32_IP_ADDRESS]`
5. Test device controls from the web interface

### Phase 3: Mobile/Web Dashboard (Day 3)

#### Option A: Use Provided React Dashboard
1. The React dashboard code is ready to use
2. Update the ESP32 IP address in the connection field
3. Click "Connect" and test all features

#### Option B: Use Blynk App (Alternative)
1. Download Blynk app (iOS/Android)
2. Create new project, select ESP32
3. Add button widgets for each device
4. Use Virtual Pins for control
5. Modify ESP32 code to include Blynk library

### Phase 4: Automation Rules (Day 4)

Test each automation:

**Motion Detection:**
- Wave hand in front of PIR sensor
- Light 1 should turn ON
- After 1 minute of no motion, should turn OFF

**Temperature Control:**
- Increase room temperature (or use heat source near sensor)
- When temp > 28Â°C, fan should turn ON
- When temp drops below 26Â°C, fan should turn OFF

---

## ğŸ”— API Documentation

### REST API Endpoints

#### 1. Control Devices
```http
GET /control?device=light1&state=1

Parameters:
- device: light1, light2, fan, outlet
- state: 1 (ON) or 0 (OFF)

Response: "OK"
```

**Example using cURL:**
```bash
curl "http://192.168.1.100/control?device=light1&state=1"
```

#### 2. Get Device Status
```http
GET /status

Response (JSON):
{
  "light1": true,
  "light2": false,
  "fan": true,
  "outlet": false
}
```

#### 3. Get Sensor Data
```http
GET /sensors

Response (JSON):
{
  "temperature": 25.5,
  "humidity": 60,
  "motion": false,
  "light": 450
}
```

#### 4. Configure Automation
```http
GET /automation?motionLight=1&tempFan=1&tempThreshold=28

Parameters:
- motionLight: 1 (enabled) or 0 (disabled)
- tempFan: 1 (enabled) or 0 (disabled)
- tempThreshold: temperature value (float)
```

### JavaScript Fetch Examples

```javascript
// Turn ON Light 1
fetch('http://192.168.1.100/control?device=light1&state=1')
  .then(response => response.text())
  .then(data => console.log(data));

// Get sensor readings
fetch('http://192.168.1.100/sensors')
  .then(response => response.json())
  .then(data => {
    console.log('Temperature:', data.temperature);
    console.log('Humidity:', data.humidity);
  });
```

---

## ğŸ”§ Troubleshooting

### Common Issues and Solutions

#### ESP32 Won't Connect to WiFi
**Symptoms:** Continuous dots in Serial Monitor, no IP displayed

**Solutions:**
1. Double-check SSID and password (case-sensitive)
2. Ensure WiFi is 2.4GHz (ESP32 doesn't support 5GHz)
3. Move ESP32 closer to router
4. Try different WiFi network
5. Check if router has MAC filtering enabled

#### Relay Not Switching
**Symptoms:** No clicking sound, devices don't turn ON/OFF

**Solutions:**
1. Check power supply (relay needs 5V)
2. Verify IN pin connections
3. Test relay with separate power source
4. Some relays need active LOW signal (invert logic)
5. Ensure relay module VCC is connected to VIN (5V)

#### DHT22 Reading NaN (Not a Number)
**Symptoms:** Serial shows "nan" for temperature/humidity

**Solutions:**
1. Check DHT22 connections (especially DATA pin)
2. Add 10kÎ© pull-up resistor between DATA and VCC
3. Increase delay between readings (minimum 2 seconds)
4. Try different DHT library version
5. Test with known working sensor

#### Motion Sensor Always Triggered
**Symptoms:** PIR constantly shows motion detected

**Solutions:**
1. Adjust sensitivity potentiometer on PIR module
2. Adjust time delay potentiometer
3. Wait for sensor to calibrate (30-60 seconds after power on)
4. Reduce room temperature fluctuations
5. Shield sensor from direct sunlight/heat sources

#### Web Interface Not Loading
**Symptoms:** Browser shows "Can't reach this page"

**Solutions:**
1. Verify ESP32 IP address (check Serial Monitor)
2. Ensure computer/phone on same WiFi network
3. Try pinging ESP32: `ping [ESP32_IP]`
4. Disable firewall temporarily
5. Check if web server started (Serial Monitor message)

---

## ğŸš€ Advanced Features

### 1. Add MQTT Support
```cpp
#include <PubSubClient.h>

WiFiClient espClient;
PubSubClient mqtt(espClient);

const char* mqtt_server = "broker.hivemq.com";

void setup() {
  // ... existing setup
  mqtt.setServer(mqtt_server, 1883);
  mqtt.setCallback(mqttCallback);
}

void mqttCallback(char* topic, byte* payload, unsigned int length) {
  String message;
  for (int i = 0; i < length; i++) {
    message += (char)payload[i];
  }
  
  if (String(topic) == "home/light1") {
    light1State = (message == "ON");
    controlDevice(LIGHT1_PIN, light1State);
  }
}
```

### 2. Add OTA (Over-The-Air) Updates
```cpp
#include <ArduinoOTA.h>

void setup() {
  // ... existing setup
  
  ArduinoOTA.setHostname("SmartHome");
  ArduinoOTA.setPassword("admin");
  
  ArduinoOTA.onStart([]() {
    Serial.println("OTA Update Starting...");
  });
  
  ArduinoOTA.begin();
}

void loop() {
  ArduinoOTA.handle();
  // ... existing loop code
}
```

### 3. Voice Control Integration
Use IFTTT or Alexa/Google Home:
1. Create IFTTT applets
2. Use webhooks to call ESP32 API
3. Example: "Alexa, turn on living room light" â†’ IFTTT â†’ ESP32

### 4. Data Logging to Cloud
```cpp
#include <HTTPClient.h>

void logToCloud() {
  HTTPClient http;
  String serverPath = "http://your-server.com/api/log";
  
  http.begin(serverPath);
  http.addHeader("Content-Type", "application/json");
  
  String json = "{\"temp\":" + String(temperature) + 
                ",\"hum\":" + String(humidity) + "}";
  
  int httpResponseCode = http.POST(json);
  http.end();
}
```

### 5. Energy Monitoring
Add ACS712 current sensor:
```cpp
#define CURRENT_SENSOR_PIN 35

float readCurrent() {
  int sensorValue = analogRead(CURRENT_SENSOR_PIN);
  float voltage = (sensorValue / 4095.0) * 3.3;
  float current = (voltage - 2.5) / 0.066;  // For 30A module
  return abs(current);
}
```

---

## ğŸ“Š Project Evaluation Criteria

### Functionality (40%)
- âœ… Devices controlled remotely via web interface
- âœ… Real-time sensor data displayed
- âœ… Automation rules working correctly
- âœ… Stable operation for extended periods

### Code Quality (20%)
- âœ… Well-structured and commented code
- âœ… Proper error handling
- âœ… Efficient resource usage
- âœ… Security considerations implemented

### Documentation (20%)
- âœ… Complete circuit diagrams
- âœ… Setup instructions
- âœ… API documentation
- âœ… Troubleshooting guide

### Innovation (20%)
- âœ… Additional features beyond requirements
- âœ… Creative automation rules
- âœ… User-friendly interface design
- âœ… Scalability considerations

---

## ğŸ¯ Next Steps & Improvements

### Short-term Enhancements
1. Add authentication to web interface
2. Implement scheduling (turn devices ON/OFF at specific times)
3. Create mobile app with Flutter/React Native
4. Add email/SMS notifications for alerts

### Long-term Goals
1. Machine learning for usage patterns
2. Integration with weather APIs
3. Multi-room/multi-device scaling
4. Power consumption monitoring and analytics
5. Integration with solar panels/battery backup

---

## ğŸ“š Learning Resources

### ESP32 Programming
- [Official ESP32 Documentation](https://docs.espressif.com/projects/esp-idf/en/latest/esp32/)
- [Random Nerd Tutorials](https://randomnerdtutorials.com/projects-esp32/)

### IoT Protocols
- [MQTT Essentials](https://www.hivemq.com/mqtt-essentials/)
- [REST API Design](https://restfulapi.net/)

### Circuit Design
- [All About Circuits](https://www.allaboutcircuits.com/)
- [Electronics-Tutorials](https://www.electronics-tutorials.ws/)

---

## âš¡ Quick Reference Commands

### Arduino IDE
```bash
# Verify/Compile
Ctrl + R (Windows/Linux) or Cmd + R (Mac)

# Upload to Board
Ctrl + U (Windows/Linux) or Cmd + U (Mac)

# Open Serial Monitor
Ctrl + Shift + M (Windows/Linux) or Cmd + Shift + M (Mac)
```

### ESP32 Board Settings
```
Board: "ESP32 Dev Module"
Upload Speed: "921600"
CPU Frequency: "240MHz"
Flash Frequency: "80MHz"
Flash Mode: "QIO"
Flash Size: "4MB"
Port: [Select your COM port]
```

---

## ğŸ“ Support & Contact

For issues or questions:
1. Check troubleshooting section
2. Review ESP32 forums
3. Check GitHub issues
4. Contact project team

**Happy Building! ğŸ âš¡**
